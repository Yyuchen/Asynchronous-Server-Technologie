<!DOCTYPE html>
<html lang ="fr">

  <head>
    <% include partials/head %>
  </head>

  <body class="container">
    <div class = "col-md-6.col-md-offset-3">
      <h1>
        Bonjour 
        <%= name %>
      </h1>
      <button class="btn btn-danger" href="/logout" onClick='document.location.href="/logout"'>
        Logout
      </button>
      <button class="btn btn-success" id="show-metrics">
        Bring the metrics
      </button>
      <div id="metrics"></div>
      <br/>
      <form action='/modif' method='post'>
        <table class='table table-bordered' style='background-color:bisque'>
          <tr>
            <td>Modifier mes informations:</td>
          </tr>
          <tr>
            <td><input name='email' class='form-control' type='text' placeholder='email'></td>
          </tr>
          <tr>
            <td><input name='pw' class='form-control' type='text' placeholder='password'></td>
          </tr>
          <tr>
            <td><input class='form-control' type='submit' value='Enregistrer'></td>
          </tr>
        </table>
      </form>
    </div>
  <div id="div1">
    
  </div>
  </body>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
<script>


  //  window.onload = function(e)
     $('#show-metrics').click((e) => {
      e.preventDefault()
      const current_user = "<%- name %>"
      $.getJSON('/getMet', {}, (data) => {
        const content = data.map(d => {
          return `timestamp: ${d.timestamp}, value: ${d.value}, owner: ${d.owner}`
        })
        // $("#metrics").append(content.join("\n"))
        var oMetrics = document.getElementById('metrics');
        oMetrics.innerText = content.join("\n");
        // $("#metrics").content.join("\n")
        console.log(content.length);

      })
    })
  </script>
</html>
